<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestión Técnica SAP</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>🚀 Gestión Técnica - Proyecto SAP</h1>
            <div class="header-info">
                <span id="currentDate"></span>
                <span id="firebaseStatus" class="status-badge">🔴 Desconectado</span>
            </div>
        </header>

        <!-- KPIs Dashboard -->
        <section class="kpis-section">
            <div class="kpi-group">
                <div class="kpi-group-header">
                    <div class="kpi-group-icon">📦</div>
                    <h3 class="kpi-group-title">Desarrollos</h3>
                </div>
                <div class="kpi-grid">
                    <div class="kpi-card-small">
                        <h4 id="totalDesarrollos" class="kpi-orange">0</h4>
                        <p>Total Desarrollos</p>
                    </div>
                    <div class="kpi-card-small">
                        <h4 id="desarrollosPendientes" class="kpi-orange">0</h4>
                        <p>Pendientes</p>
                    </div>
                    <div class="kpi-card-small">
                        <h4 id="desarrollosEnProceso" class="kpi-orange">0</h4>
                        <p>En Proceso</p>
                    </div>
                    <div class="kpi-card-small">
                        <h4 id="desarrollosTerminados" class="kpi-orange">0</h4>
                        <p>Terminados</p>
                    </div>
                </div>
            </div>

            <div class="kpi-group">
                <div class="kpi-group-header">
                    <div class="kpi-group-icon">🚀</div>
                    <h3 class="kpi-group-title">Fiori Launchpad</h3>
                </div>
                <div class="kpi-grid">
                    <div class="kpi-card-small">
                        <h4 id="totalFiori" class="kpi-dark">0</h4>
                        <p>Total Publicaciones</p>
                    </div>
                    <div class="kpi-card-small">
                        <h4 id="fioriEstandar" class="kpi-dark">0</h4>
                        <p>Trx Estándar</p>
                    </div>
                    <div class="kpi-card-small">
                        <h4 id="fioriZ" class="kpi-dark">0</h4>
                        <p>Trx Z</p>
                    </div>
                    <div class="kpi-card-small">
                        <h4 id="fioriApps" class="kpi-dark">0</h4>
                        <p>App Fiori</p>
                    </div>
                </div>
            </div>

            <div class="kpi-group">
                <div class="kpi-group-header">
                    <div class="kpi-group-icon">🔄</div>
                    <h3 class="kpi-group-title">Órdenes Transporte</h3>
                </div>
                <div class="kpi-grid">
                    <div class="kpi-card-small">
                        <h4 id="totalOTs" class="kpi-red">0</h4>
                        <p>Total Órdenes</p>
                    </div>
                    <div class="kpi-card-small">
                        <h4 id="otsDEV" class="kpi-red">0</h4>
                        <p>Desarrollo</p>
                    </div>
                    <div class="kpi-card-small">
                        <h4 id="otsQAS" class="kpi-red">0</h4>
                        <p>Calidad</p>
                    </div>
                    <div class="kpi-card-small">
                        <h4 id="otsPRD" class="kpi-red">0</h4>
                        <p>Producción</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Navigation Tabs -->
        <nav class="tabs">
            <button class="tab-btn active" data-tab="desarrollos">Listado Desarrollos</button>
            <button class="tab-btn" data-tab="fiori">Fiori Launchpad</button>
            <button class="tab-btn" data-tab="transportes">Órdenes de Transporte</button>
        </nav>

        <!-- Tab Content: Desarrollos -->
        <div class="tab-content active" id="desarrollos">
            <div class="section-header">
                <h2>Gestión de Desarrollos</h2>
                <button class="btn-primary" onclick="openModal('desarrollosModal')">+ Nuevo Desarrollo</button>
            </div>
            
            <!-- Filtros Desarrollos -->
            <div class="filters-container">
                <div class="search-box">
                    <input type="text" id="searchDesarrollos" placeholder="Buscar por ID, nombre, desarrollador...">
                </div>
                <div class="filter-group">
                    <select class="filter-select" id="filterDesarrollosTipo">
                        <option value="">Todos los Tipos</option>
                        <option value="Report">Report</option>
                        <option value="Function">Function</option>
                        <option value="Class">Class</option>
                        <option value="Enhancement">Enhancement</option>
                        <option value="WebService">Web Service</option>
                        <option value="Smartform">Smartform</option>
                        <option value="Adobe Form">Adobe Form</option>
                        <option value="BADI">BADI</option>
                        <option value="User Exit">User Exit</option>
                        <option value="BTE">BTE</option>
                        <option value="Workflow">Workflow</option>
                        <option value="Interface">Interface</option>
                        <option value="App Fiori">App Fiori</option>
                        <option value="Programa Integración">Programa Integración</option>
                    </select>
                    <select class="filter-select" id="filterDesarrollosEstado">
                        <option value="">Todos los Estados</option>
                        <option value="PENDIENTE">PENDIENTE</option>
                        <option value="SIN ETF">SIN ETF</option>
                        <option value="VALIDACION ETF">VALIDACION ETF</option>
                        <option value="ETF OK">ETF OK</option>
                        <option value="ETF DEVUELTA">ETF DEVUELTA</option>
                        <option value="EN DESARROLLO">EN DESARROLLO</option>
                        <option value="COPIADO EN DESARROLLO">COPIADO EN DESARROLLO</option>
                        <option value="COPIADO COMPLETO">COPIADO COMPLETO</option>
                        <option value="EN PRUEBAS">EN PRUEBAS</option>
                        <option value="TERMINADO">TERMINADO</option>
                    </select>
                    <select class="filter-select" id="filterDesarrollosModulo">
                        <option value="">Todos los Módulos</option>
                        <option value="FI">FI - Finanzas</option>
                        <option value="CO">CO - Controlling</option>
                        <option value="MM">MM - Materiales</option>
                        <option value="SD">SD - Ventas</option>
                        <option value="PP">PP - Producción</option>
                        <option value="QM">QM - Calidad</option>
                        <option value="PM">PM - Mantenimiento</option>
                        <option value="HR">HR - Recursos Humanos</option>
                        <option value="PS">PS - Proyectos</option>
                        <option value="WM">WM - Warehouse</option>
                        <option value="Basis">Basis</option>
                        <option value="Cross">Cross Module</option>
                    </select>
                    <button class="btn-clear-filters" onclick="clearFiltersDesarrollos()">Limpiar</button>
                </div>
            </div>
            
            <div class="table-container">
                <table id="desarrollosTable">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Nombre</th>
                            <th>Tipo</th>
                            <th>Módulo</th>
                            <th>Funcional</th>
                            <th>Desarrollador</th>
                            <th>Estado</th>
                            <th>OT</th>
                            <th>Fec.Inicio</th>
                            <th>Fec.Término</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="desarrollosBody"></tbody>
                </table>
            </div>
        </div>

        <!-- Tab Content: Fiori -->
        <div class="tab-content" id="fiori">
            <div class="section-header">
                <h2>Aplicaciones Fiori Launchpad</h2>
                <button class="btn-primary" onclick="openModal('fioriModal')">+ Nueva Aplicación</button>
            </div>
            
            <!-- Filtros Fiori -->
            <div class="filters-container">
                <div class="search-box">
                    <input type="text" id="searchFiori" placeholder="Buscar por ID, nombre, semantic object...">
                </div>
                <div class="filter-group">
                    <select class="filter-select" id="filterFioriTipo">
                        <option value="">Todos los Tipos</option>
                        <option value="App Fiori">App Fiori</option>
                        <option value="Transacción Z">Transacción Z</option>
                        <option value="Transacción Estándar">Transacción Estándar</option>
                    </select>
                    <select class="filter-select" id="filterFioriEstado">
                        <option value="">Todos los Estados</option>
                        <option value="Configuración">Configuración</option>
                        <option value="Testing">Testing</option>
                        <option value="Publicado">Publicado</option>
                        <option value="Inactivo">Inactivo</option>
                    </select>
                    <button class="btn-clear-filters" onclick="clearFiltersFiori()">Limpiar</button>
                </div>
            </div>
            
            <div class="table-container">
                <table id="fioriTable">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Nombre App</th>
                            <th>Tipo</th>
                            <th>Tx / App</th>
                            <th>Semantic Object</th>
                            <th>Catálogo</th>
                            <th>Desarrollador</th>
                            <th>Estado</th>
                            <th>Fecha Publ.</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="fioriBody"></tbody>
                </table>
            </div>
        </div>

        <!-- Tab Content: Transportes -->
        <div class="tab-content" id="transportes">
            <div class="section-header">
                <h2>Órdenes de Transporte</h2>
                <button class="btn-primary" onclick="openModal('transportesModal')">+ Nueva Orden</button>
            </div>
            
            <!-- Filtros Transportes -->
            <div class="filters-container">
                <div class="search-box">
                    <input type="text" id="searchTransportes" placeholder="Buscar por orden, descripción, solicitante...">
                </div>
                <div class="filter-group">
                    <select class="filter-select" id="filterTransportesTipo">
                        <option value="">Todos los Tipos</option>
                        <option value="Workbench">Workbench</option>
                        <option value="Customizing">Customizing</option>
                        <option value="Copy">Copy</option>
                        <option value="Relocation">Relocation</option>
                    </select>
                    <select class="filter-select" id="filterTransportesAmbiente">
                        <option value="">Todos los Ambientes</option>
                        <option value="DEV">DEV</option>
                        <option value="QAS">QAS</option>
                        <option value="PRD">PRD</option>
                    </select>
                    <select class="filter-select" id="filterTransportesEstado">
                        <option value="">Todos los Estados</option>
                        <option value="Pendiente">Pendiente</option>
                        <option value="En Revisión">En Revisión</option>
                        <option value="Aprobado">Aprobado</option>
                        <option value="Liberado">Liberado</option>
                        <option value="Transportado">Transportado</option>
                    </select>
                    <button class="btn-clear-filters" onclick="clearFiltersTransportes()">Limpiar</button>
                </div>
            </div>
            
            <div class="table-container">
                <table id="transportesTable">
                    <thead>
                        <tr>
                            <th>Orden</th>
                            <th>Tipo</th>
                            <th>Descripción</th>
                            <th>Ambiente</th>
                            <th>Estado</th>
                            <th>Usuario SAP</th>
                            <th>Fecha Creación</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="transportesBody"></tbody>
                </table>
            </div>
        </div>

        <!-- Modal Desarrollos -->
        <div id="desarrollosModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeModal('desarrollosModal')">&times;</span>
                <h2 id="desarrollosModalTitle">Nuevo Desarrollo</h2>
                <form id="desarrollosForm">
                    <input type="hidden" id="desarrollo_key">
                    <div class="form-row">
                        <div class="form-group">
                            <label>ID Desarrollo: *</label>
                            <input type="text" id="desarrollo_id" required placeholder="Ej: Z_REP_001">
                        </div>
                        <div class="form-group">
                            <label>Nombre: *</label>
                            <input type="text" id="desarrollo_nombre" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Tipo: *</label>
                            <select id="desarrollo_tipo" required>
                                <option value="">Seleccionar...</option>
                                <option value="Report">Report</option>
                                <option value="Function">Function</option>
                                <option value="Class">Class</option>
                                <option value="Enhancement">Enhancement</option>
                                <option value="WebService">Web Service</option>
                                <option value="Smartform">Smartform</option>
                                <option value="Adobe Form">Adobe Form</option>
                                <option value="BADI">BADI</option>
                                <option value="User Exit">User Exit</option>
                                <option value="BTE">BTE</option>
                                <option value="Workflow">Workflow</option>
                                <option value="Interface">Interface</option>
                                <option value="App Fiori">App Fiori</option>
                                <option value="Programa Integración">Programa Integración</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Módulo SAP: *</label>
                            <select id="desarrollo_modulo" required>
                                <option value="">Seleccionar...</option>
                                <option value="FI">FI - Finanzas</option>
                                <option value="CO">CO - Controlling</option>
                                <option value="MM">MM - Materiales</option>
                                <option value="SD">SD - Ventas</option>
                                <option value="PP">PP - Producción</option>
                                <option value="QM">QM - Calidad</option>
                                <option value="PM">PM - Mantenimiento</option>
                                <option value="HR">HR - Recursos Humanos</option>
                                <option value="PS">PS - Proyectos</option>
                                <option value="WM">WM - Warehouse</option>
                                <option value="Basis">Basis</option>
                                <option value="Cross">Cross Module</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Funcional: *</label>
                            <input type="text" id="desarrollo_funcional" required>
                        </div>
                        <div class="form-group">
                            <label>Desarrollador: *</label>
                            <input type="text" id="desarrollo_desarrollador" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Estado: *</label>
                            <select id="desarrollo_estado" required>
                                <option value="PENDIENTE">PENDIENTE</option>
                                <option value="SIN ETF">SIN ETF</option>
                                <option value="VALIDACION ETF">VALIDACION ETF</option>
                                <option value="ETF OK">ETF OK</option>
                                <option value="ETF DEVUELTA">ETF DEVUELTA</option>
                                <option value="EN DESARROLLO">EN DESARROLLO</option>
                                <option value="COPIADO EN DESARROLLO">COPIADO EN DESARROLLO</option>
                                <option value="COPIADO COMPLETO">COPIADO COMPLETO</option>
                                <option value="EN PRUEBAS">EN PRUEBAS</option>
                                <option value="TERMINADO">TERMINADO</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Orden Transporte:</label>
                            <input type="text" id="desarrollo_ot" placeholder="Opcional">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Fecha Inicio: *</label>
                            <input type="date" id="desarrollo_fecha_inicio" required>
                        </div>
                        <div class="form-group">
                            <label>Fecha Término:</label>
                            <input type="date" id="desarrollo_fecha_termino">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Observaciones:</label>
                        <textarea id="desarrollo_observaciones" rows="3" style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 10px; font-size: 0.95rem; font-family: inherit; resize: vertical;" placeholder="Ingrese observaciones opcionales..."></textarea>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn-primary">Guardar</button>
                        <button type="button" class="btn-secondary" onclick="closeModal('desarrollosModal')">Cancelar</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Modal Fiori -->
        <div id="fioriModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeModal('fioriModal')">&times;</span>
                <h2 id="fioriModalTitle">Nueva Aplicación Fiori</h2>
                <form id="fioriForm">
                    <input type="hidden" id="fiori_key">
                    <div class="form-row">
                        <div class="form-group">
                            <label>ID Aplicación: *</label>
                            <input type="text" id="fiori_id" required placeholder="Ej: FIORI_001">
                        </div>
                        <div class="form-group">
                            <label>Nombre Aplicación: *</label>
                            <input type="text" id="fiori_nombre" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Tipo Aplicación: *</label>
                            <select id="fiori_tipo" required>
                                <option value="">Seleccionar...</option>
                                <option value="App Fiori">App Fiori</option>
                                <option value="Transacción Z">Transacción Z</option>
                                <option value="Transacción Estándar">Transacción Estándar</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Tx / App: *</label>
                            <input type="text" id="fiori_tx_app" required placeholder="Ej: SE38 o ZMI_APP">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Semantic Object: *</label>
                            <input type="text" id="fiori_semantic" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Catálogo: *</label>
                            <input type="text" id="fiori_catalogo" required>
                        </div>
                        <div class="form-group">
                            <label>Desarrollador: *</label>
                            <input type="text" id="fiori_desarrollador" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Estado: *</label>
                            <select id="fiori_estado" required>
                                <option value="Configuración">Configuración</option>
                                <option value="Testing">Testing</option>
                                <option value="Publicado">Publicado</option>
                                <option value="Inactivo">Inactivo</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Fecha Publicación: *</label>
                            <input type="date" id="fiori_fecha" required>
                        </div>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn-primary">Guardar</button>
                        <button type="button" class="btn-secondary" onclick="closeModal('fioriModal')">Cancelar</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Modal Transportes -->
        <div id="transportesModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeModal('transportesModal')">&times;</span>
                <h2 id="transportesModalTitle">Nueva Orden de Transporte</h2>
                <form id="transportesForm">
                    <input type="hidden" id="transporte_key">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Orden de Transporte: *</label>
                            <input type="text" id="transporte_orden" required placeholder="Ej: DEVK900123">
                        </div>
                        <div class="form-group">
                            <label>Tipo Orden: *</label>
                            <select id="transporte_tipo" required>
                                <option value="">Seleccionar...</option>
                                <option value="Workbench">Workbench</option>
                                <option value="Customizing">Customizing</option>
                                <option value="Copy">Copy</option>
                                <option value="Relocation">Relocation</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Descripción: *</label>
                        <input type="text" id="transporte_descripcion" required>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Ambiente: *</label>
                            <select id="transporte_ambiente" required>
                                <option value="">Seleccionar...</option>
                                <option value="DEV">Desarrollo (DEV)</option>
                                <option value="QAS">Calidad (QAS)</option>
                                <option value="PRD">Producción (PRD)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Estado: *</label>
                            <select id="transporte_estado" required>
                                <option value="Pendiente">Pendiente</option>
                                <option value="En Revisión">En Revisión</option>
                                <option value="Aprobado">Aprobado</option>
                                <option value="Liberado">Liberado</option>
                                <option value="Transportado">Transportado</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Usuario SAP: *</label>
                            <input type="text" id="transporte_usuario_sap" required>
                        </div>
                        <div class="form-group">
                            <label>Fecha Creación: *</label>
                            <input type="date" id="transporte_fecha" required>
                        </div>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn-primary">Guardar</button>
                        <button type="button" class="btn-secondary" onclick="closeModal('transportesModal')">Cancelar</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div id="loading" class="loading">
        <div class="spinner"></div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <script src="app.js"></script>
</body>
</html>